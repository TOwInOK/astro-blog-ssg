---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import BaseHead from "@components/BaseHead.astro";
import FormattedDate from "@components/FormattedDate.astro";
import Header from "@components/Header.astro";
import BareCode from "@components/BareCode.astro";
import Carousel from "@components/Carousel.astro";
type Props = CollectionEntry<"blog">["data"];
const { title, description, pubDate, updatedDate, images, heroImage } =
  Astro.props;
---

<html lang="en">
  <head>
    <BaseHead title={title} description={description} />
  </head>

  <body class="relative bg-black">
    <Header />

    <main class="mx-auto max-w-3xl px-4">
      {
        images && (
          <Carousel>
            {images &&
              images.map(
                (image, index) =>
                  image && (
                    <Image
                      loading={index < 2 ? "lazy" : "eager"}
                      width={1020}
                      height={510}
                      src={image}
                      alt=""
                      class="embla__slide"
                    />
                  ),
              )}
          </Carousel>
        )
      }
      {
        heroImage && !images && (
          <Image
            loading="lazy"
            width={1020}
            height={510}
            src={heroImage}
            alt=""
            class="shadow-accent mb-2 aspect-6/3 w-full rounded-xl shadow-2xl transition duration-200 ease-in-out"
          />
        )
      }

      <div
        class="prose prose-invert prose-img:rounded-xl lg:prose-lg xl:prose-xl mx-auto"
      >
        <div class="text-center">
          <div class="pt-2 pb-8 text-gray-400">
            <FormattedDate date={pubDate} />
            {
              updatedDate && (
                <div class="text-base italic">
                  Last updated on <FormattedDate date={updatedDate} />
                </div>
              )
            }
          </div>
          <h1>{title}</h1>
          <hr />
        </div>
        <slot />
      </div>
    </main>

    <BareCode
      class="text-accent absolute bottom-0 scale-y-300 mask-t-from-red-200 mask-t-to-90% mask-r-to-130% mask-l-to-130% lg:scale-100"
    />
  </body>
</html>
